<html>
	<head>
	<meta name="apple-mobile-web-app-capable" content="yes">
	<title>Sweeping App 2.0 - Session Launcher</title>
	<style>
	
	.tbutton {
	  height: 28px;
	  font-weight: bold;
	  font-size:24px;
	}

	.teacher {
	  font-size: 24px;
	  font-weight: bold;
	}

    .opts {
        font-size: 18px;
    }

    .otitle {
        font-size: 20px;
    }
	
	body {
		background-color: aliceblue;
	}

	p {
	  font-size: 20px;
	}

	</style>
	</head>
	
	<body onbeforeunload="return myFunction()">
		<label class="teacher" for="sname">Session Name: </label>
		<input id="sname" class="teacher" type="text" size="20" onkeyup="updateLinks();">
		<input id="tbutt" class="tbutton" type="button" value="Update" onclick="updateLinks();">
		<p>
		[Please only use letters, numbers, or the 'underscore' character (_) in session names]
		</p>
        <div class="otitle"><i>Options</i></div>
        <label class="opts" for="modeselect">Mode: </label>
        <select id="modeselect" onchange="updateLinks()">
			<option value="sweep">Sweep</option>
			<option value="geoboard">GeoBoard</option>
		</select>
       <br>
        <label class="opts" for="rotation">Rotation: </label>
        <input class="opts" type="checkbox" id="rotation" value="rotation" onchange="updateLinks()" checked><span class="opts">Allow Rotation of Pieces</span><br>
		<br>
		<label class="opts" for="reflection">Reflection: </label>
		<input class="opts" type="checkbox" id="reflection" value="reflection" onchange="updateLinks()" checked><span class="opts">Allow Reflection of Pieces</span><br>
		<br>

        <div id="advancedopts" hidden>
            <div class="otitle"><i>Advanced Options (GeoBoard Specific)</i></div>
            <label class="opts" for="vertices">Vertices: </label>
            <input type="text" id="vertices" class="opts" size="50" onkeyup="updateLinks();"><br>
            <br>
            <label class="opts" for="outvertices">Outlines: </label>
            <input type="text" id="outvertices" class="opts" size="50" onkeyup="updateLinks();"><br>
            <br>
        </div>

	<div id="copier">
		<p><i>Link to Full Screen Sweeper (student interface):</i><br>&nbsp;&nbsp;<a id="asweeponly" href="."><span id="linktextso">[Link will show here]</span></a></p>
		<p><i>Link to Sweeper with Gallery (student or teacher interface):</i><br>&nbsp;&nbsp;<a id="asweepplus" href="."><span id="linktextsp">[Link will show here]</span></a></p>
	</div>
	
	<script>
		function myFunction() {
	  		return "Write something clever here...";
		}
		
		function updateLinks(  ) {
			let loc = window.location.href;
			let cutpt = loc.lastIndexOf("/");
			loc = loc.substr(0,cutpt);
			loconly = loc + "/sweeponly.html";
			locplus = loc + "/index.html";

			let modeval = document.getElementById("modeselect").selectedIndex;
			let qstring = "?mode=";
			if (modeval == 1) {
			    qstring += "5";
                document.getElementById("advancedopts").hidden = false;
                qstring += "&vertices=" + document.getElementById("vertices").value;
                qstring += "&outvertices=" + document.getElementById("outvertices").value;
			} else {
                qstring += "1";
                document.getElementById("advancedopts").hidden = true;
            }
			let rotation = document.getElementById("rotation").checked;
			console.log(rotation);
            if (rotation == true) {
                qstring += "&rotation=true";
            } else {
                qstring += "&rotation=false";
            }
			let reflection = document.getElementById("reflection").checked;
			console.log(reflection);
			if (reflection == true) {
				qstring += "&reflection=true";
			} else {
				qstring += "&reflection=false";
			}
			
			let currentvalue = document.getElementById("sname").value;
			let touse = (currentvalue.length < 1) ? "public" : currentvalue;
			//touse = encodeURI(touse);
			touse = touse.replace(/[^a-zA-Z0-9-_]/g, '');
			touse = "#" + touse;
			
			let linktextsonly = loconly + qstring + touse;
			let linkso = document.getElementById("asweeponly");
			linkso.href = linktextsonly;
			document.getElementById("linktextso").innerHTML = linktextsonly;
			
			let linktextsg = locplus + qstring + touse;
			let linksp = document.getElementById("asweepplus");
			linksp.href = linktextsg;
			document.getElementById("linktextsp").innerHTML = linktextsg;
		}
		updateLinks();
	</script>
	</body>
</html>